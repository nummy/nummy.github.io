<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description"><meta name="viewport" content="width=device-width, initial-scale=1"><title>scala学习笔记【2】流程与函数 · Nummy</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">Nummy</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">scala学习笔记【2】流程与函数</h1><span class="post-time">Sep 3, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Directory</h3><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#条件表达式"><span class="toc-text">条件表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#语句终止"><span class="toc-text">语句终止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#块表达式和赋值"><span class="toc-text">块表达式和赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输入和输出"><span class="toc-text">输入和输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#循环"><span class="toc-text">循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级for循环和for推导式"><span class="toc-text">高级for循环和for推导式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数"><span class="toc-text">函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认参数和带名参数"><span class="toc-text">默认参数和带名参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变长参数"><span class="toc-text">变长参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#过程"><span class="toc-text">过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#懒值"><span class="toc-text">懒值</span></a></li></ol></div><div class="post-content"><h3 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h3><p>scala的if/esle语法结构与Java一样，但是在scala中if/else表达式有值，这个值就是跟在if或else之后表达式的值。</p>
<p>我们可以将if/else表达式的值赋予给变量：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> s = <span class="keyword">if</span> (x&gt;<span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> <span class="number">-1</span></div></pre></td></tr></table></figure></p>
<p>它等价于<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x&gt;<span class="number">0</span>) s = <span class="number">1</span> <span class="keyword">else</span> s = <span class="number">-1</span></div></pre></td></tr></table></figure></p>
<p>不过，第一种写法更好，因为它可以用来初始化一个val， 而第二种写法中，s必须是var。</p>
<p>在Scala中，每个表达式都有一个类型。</p>
<p>如果是混合类型，则类型为Any。</p>
<p>如果else部分缺失，例如：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x&gt;<span class="number">0</span>) <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>等价于<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x&gt;<span class="number">0</span>) <span class="keyword">else</span> ()</div></pre></td></tr></table></figure></p>
<p>Scala没有switch语句，但是它有一个更强大的模式匹配机制。</p>
<h3 id="语句终止"><a href="#语句终止" class="headerlink" title="语句终止"></a>语句终止</h3><p>在scala中，分号绝大多数情况下都不是必须的。不过如果你想在单行中写下多个语句，则需要将它们以分号隔开。</p>
<h3 id="块表达式和赋值"><a href="#块表达式和赋值" class="headerlink" title="块表达式和赋值"></a>块表达式和赋值</h3><p>在Scala中，{}包含一系列表达式，块中最后一个表达式的值就是块的值。</p>
<p>在Scala中赋值语句是没有值的，所以别把它们串接在一起。<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x = y = <span class="number">1</span> <span class="comment">//别这样做</span></div></pre></td></tr></table></figure></p>
<h3 id="输入和输出"><a href="#输入和输出" class="headerlink" title="输入和输出"></a>输入和输出</h3><p>使用print或者println打印一个值。</p>
<p>使用printf格式化输出。</p>
<p>使用readLine从控制台读取一行输入，如果是读取数字，Boolean或者字符串，可以使用readInt, readDouble, readByte, readShort, readLong, readFloat, readBoolean或者 readChar。与其他方法不同，readLine带一个参数作为提示字符串。</p>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>scala支持while循环和for循环，while循环与Java的while一样，for循环语法如下：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>( i &lt;- 表达式)</div></pre></td></tr></table></figure></p>
<p>遍历字符串和数组时，你通常需要使用0 到n-1的区间，这个时候可以使用until方法而不是to方法。until方法返回一个并不包含上限的区间。</p>
<h3 id="高级for循环和for推导式"><a href="#高级for循环和for推导式" class="headerlink" title="高级for循环和for推导式"></a>高级for循环和for推导式</h3><p>可以使用变量<code>&lt;-</code>表达式的形式提供多个生成器，用分号隔开。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for(i &lt;-1 to 3, j &lt;- 1 to 3) print ((10*i+j)+ &quot; &quot;)</div></pre></td></tr></table></figure></p>
<p>每个生成器还可以带过滤条件，以if开头的Boolean表达式。<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(i &lt;<span class="number">-1</span> to <span class="number">3</span>, j &lt;- <span class="number">1</span> to <span class="number">3</span> <span class="keyword">if</span> i != j) print ((<span class="number">10</span>*i+j)+ <span class="string">" "</span>)</div></pre></td></tr></table></figure></p>
<p>还可以使用任意多的定义，引入可以在循环中使用的变量：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>( i &lt;- <span class="number">1</span> to <span class="number">3</span>; from = <span class="number">4</span>-i; j &lt;- from to <span class="number">3</span>)  print ((<span class="number">10</span>*i+j)+ <span class="string">" "</span>)</div></pre></td></tr></table></figure></p>
<p>如果for循环的循环体以yield开始，则该循环会构造出一个集合，每次迭代出集合中的一个值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for( i &lt;- 1 to 10) yield i % 3</div></pre></td></tr></table></figure></p>
<p>这类循环叫做for推导式。</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>要定义函数，需要给出函数的名称、参数和函数体：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">def abs(x:Double) = if (x&gt;0) x else -x</div></pre></td></tr></table></figure></p>
<p>必须给出所有参数的类型，不过，只要函数不是递归的，就不需要指定返回类型。Scala编译器可以通过=右侧的表达式推断出返回类型。</p>
<p>如果函数体需要多个表达式完成，可以使用代码块，块中最后一个表达式的值就是函数的返回值。</p>
<p>对于递归函数，必须指定返回类型。</p>
<h3 id="默认参数和带名参数"><a href="#默认参数和带名参数" class="headerlink" title="默认参数和带名参数"></a>默认参数和带名参数</h3><p>scala中可以给函数提供默认参数：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span></span>(num:<span class="type">Int</span> = <span class="number">2</span>) num += <span class="number">3</span></div></pre></td></tr></table></figure></p>
<p>还可以在提供参数值的时候指定参数名。带名参数不需要跟参数列表的顺序完全一致。</p>
<h3 id="变长参数"><a href="#变长参数" class="headerlink" title="变长参数"></a>变长参数</h3><p>scala中还支持接收可变长度参数列表：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(args: <span class="type">Int</span>*)&#123;</div><div class="line">    <span class="keyword">var</span> result = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span>(arg &lt;- args) result += arg</div><div class="line">    result</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>函数得到的是一个类型为Seq的参数。</p>
<p>如果你已经有一个值的序列，则不能直接将它传进上述函数。例如：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> s = sum(<span class="number">1</span> to <span class="number">5</span>) <span class="comment">//错误</span></div></pre></td></tr></table></figure></p>
<p>如果sum函数被调用时传入的是单个参数，那么该参数必须是单个整数，而不是一个整数区间。解决这个问题的办法是告诉编译器你希望这个参数被当作参数序列来处理，追加：_*。例如：<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> s = sum(<span class="number">1</span> to <span class="number">5</span>: _*)</div></pre></td></tr></table></figure></p>
<h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><p>scala中不返回值的函数有特殊的表示法，如果函数体包含在花括号当中，但没有前面的=号，那么返回类型就是Unit。这样的函数称之为过程。</p>
<p>由于过程不返回值，所以我们省略=号。</p>
<h3 id="懒值"><a href="#懒值" class="headerlink" title="懒值"></a>懒值</h3><p>当val被声明为lazy时，它的初始化将被推迟，直到我们首次对它赋值。<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lazy</span> <span class="keyword">val</span> words = scala.io.<span class="type">Source</span>.fromFile(<span class="string">"a.txt"</span>).mkString</div></pre></td></tr></table></figure></p>
<p>如果程序从不访问a.txt，那么它就不会被打开。<br>懒值对于初始化开销较大的初始化语句而言十分有用。</p>
<p>###　异常<br>scala异常工作机制与Java一样，但是scala没有受检异常。</p>
<p>throw有特殊的类型值Nothing，这在if/else语句中特别有用，如果一个分支的类型是Nothing，那么if/else表达式的类型就是另一个分支的类型。</p>
<p>捕获异常的语法采用模式匹配的语法，更通用的异常应该排在更具体的异常后面。</p>
<p>如果不需要使用捕获的异常名，可以使用_代替变量名。</p>
</div></article><div class="tags"><a href="/tags/scala/">scala</a></div><div class="paginator"><a href="/2016/09/03/scala-array/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://nummy.github.io/2016/09/03/scala-flow/index.html" data-title="scala学习笔记【2】流程与函数" data-url="http://nummy.github.io/2016/09/03/scala-flow/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "nummy" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="copyright"><p>&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Nummy Lee</span></p><p class="theme">Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></html>